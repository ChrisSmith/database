select
    sum(l_extendedprice*l_discount) as revenue
from
    lineitem
where
        l_shipdate >= date '1994-01-01'
    and l_shipdate < date '1994-01-01' + interval '1' year
    and l_discount between 0.06 - 0.01 and 0.06 + 0.01
    and l_quantity < 24;


Original
Project(revenue, rows=5401093) -> .revenue
 Agg(sum(l_extendedprice * l_discount)) group by (, rows=5401093) -> .revenue 
    Filter(l_shipdate >= 01/01/1994 00:00:00 and l_shipdate < 01/01/1995 00:00:00 and l_discount between 0.05 and 0.07 and l_quantity < cast(24 as Decimal), rows=5401093) -> .l_orderkey, .l_partkey, .l_suppkey, .l_linenumber, .l_quantity, .l_extendedprice, .l_discount, .l_tax, .l_returnflag, .l_linestatus, .l_shipdate, .l_commitdate, .l_receiptdate, .l_shipinstruct, .l_shipmode, .l_comment    
       Scan(lineitem, rows=6001215) -> .l_orderkey, .l_partkey, .l_suppkey, .l_linenumber, .l_quantity, .l_extendedprice, .l_discount, .l_tax, .l_returnflag, .l_linestatus, .l_shipdate, .l_commitdate, .l_receiptdate, .l_shipinstruct, .l_shipmode, .l_comment       


Optimized
Project(revenue, rows=3937395) -> .revenue
 Agg(sum(l_extendedprice * l_discount)) group by (, rows=3937395) -> .revenue 
    Filter(l_quantity < cast(24 as Decimal), rows=3937395) -> .l_quantity, .l_extendedprice, .l_discount, .l_shipdate    
       Filter(l_discount between 0.05 and 0.07, rows=4374884) -> .l_quantity, .l_extendedprice, .l_discount, .l_shipdate       
          Filter(l_shipdate < 01/01/1995 00:00:00, rows=4860983) -> .l_quantity, .l_extendedprice, .l_discount, .l_shipdate          
             Filter(l_shipdate >= 01/01/1994 00:00:00, rows=5401093) -> .l_quantity, .l_extendedprice, .l_discount, .l_shipdate             
                Scan(lineitem, rows=6001215) with projection  -> .l_quantity, .l_extendedprice, .l_discount, .l_shipdate                


Cost Optimized
Project(revenue) cost (output_rows=600, cpu=600, disk=0, total=32675) -> .revenue
 UngroupedAggregate(sum(l_extendedprice * l_discount)) cost (output_rows=600, cpu=600, disk=0, total=32675) -> .revenue 
    Filter(l_quantity < cast(24 as Decimal)) cost (output_rows=600, cpu=24004, disk=0, total=32674) -> .l_quantity, .l_extendedprice, .l_discount, .l_shipdate    
       Filter(l_discount between 0.05 and 0.07) cost (output_rows=6001, cpu=240048, disk=0, total=32650) -> .l_quantity, .l_extendedprice, .l_discount, .l_shipdate       
          Filter(l_shipdate < 01/01/1995 00:00:00) cost (output_rows=60012, cpu=2400484, disk=0, total=32410) -> .l_quantity, .l_extendedprice, .l_discount, .l_shipdate          
             Filter(l_shipdate >= 01/01/1994 00:00:00) cost (output_rows=600121, cpu=24004860, disk=0, total=30010) -> .l_quantity, .l_extendedprice, .l_discount, .l_shipdate             
                FileScan({SolutionDirectory}tpch/1/lineitem2.parquet) cost (output_rows=6001215, cpu=6001215, disk=49, total=6005) -> .l_quantity, .l_extendedprice, .l_discount, .l_shipdate