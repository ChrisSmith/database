select
    sum(l_extendedprice*l_discount) as revenue
from
    lineitem
where
        l_shipdate >= date '1994-01-01'
    and l_shipdate < date '1994-01-01' + interval '1' year
    and l_discount between 0.06 - 0.01 and 0.06 + 0.01
    and l_quantity < 24;


Original
Project(revenue, rows=1200243) -> .revenue
 Agg(sum(l_extendedprice * l_discount)) group by (, rows=1200243) -> .revenue 
    Filter(l_shipdate >= 01/01/1994 00:00:00 and l_shipdate < 01/01/1995 00:00:00 and l_discount between 0.05 and 0.07 and l_quantity < 24, rows=1200243) -> .l_orderkey, .l_partkey, .l_suppkey, .l_linenumber, .l_quantity, .l_extendedprice, .l_discount, .l_tax, .l_returnflag, .l_linestatus, .l_shipdate, .l_commitdate, .l_receiptdate, .l_shipinstruct, .l_shipmode, .l_comment    
       Scan(lineitem, rows=6001215) -> .l_orderkey, .l_partkey, .l_suppkey, .l_linenumber, .l_quantity, .l_extendedprice, .l_discount, .l_tax, .l_returnflag, .l_linestatus, .l_shipdate, .l_commitdate, .l_receiptdate, .l_shipinstruct, .l_shipmode, .l_comment       


Optimized
Project(revenue, rows=1200243) -> .revenue
 Agg(sum(l_extendedprice * l_discount)) group by (, rows=1200243) -> .revenue 
    Filter(l_quantity < 24, rows=1200243) -> .l_quantity, .l_extendedprice, .l_discount, .l_shipdate    
       Filter(l_discount between 0.05 and 0.07, rows=1200243) -> .l_quantity, .l_extendedprice, .l_discount, .l_shipdate       
          Filter(l_shipdate < 01/01/1995 00:00:00, rows=1200243) -> .l_quantity, .l_extendedprice, .l_discount, .l_shipdate          
             Filter(l_shipdate >= 01/01/1994 00:00:00, rows=1200243) -> .l_quantity, .l_extendedprice, .l_discount, .l_shipdate             
                Scan(lineitem, rows=6001215) with projection  -> .l_quantity, .l_extendedprice, .l_discount, .l_shipdate                


Cost Optimized
Project(revenue) cost (output_rows=1200243, cpu=1200243, disk=0, total=46813) -> .revenue
 UngroupedAggregate(sum(l_extendedprice * l_discount)) cost (output_rows=1200243, cpu=1200243, disk=0, total=45613) -> .revenue 
    Filter(l_quantity < 24) cost (output_rows=1200243, cpu=4800972, disk=0, total=44412) -> .l_quantity, .l_extendedprice, .l_discount, .l_shipdate    
       Filter(l_discount between 0.05 and 0.07) cost (output_rows=1200243, cpu=4800972, disk=0, total=39612) -> .l_quantity, .l_extendedprice, .l_discount, .l_shipdate       
          Filter(l_shipdate < 01/01/1995 00:00:00) cost (output_rows=1200243, cpu=4800972, disk=0, total=34811) -> .l_quantity, .l_extendedprice, .l_discount, .l_shipdate          
             Filter(l_shipdate >= 01/01/1994 00:00:00) cost (output_rows=1200243, cpu=24004860, disk=0, total=30010) -> .l_quantity, .l_extendedprice, .l_discount, .l_shipdate             
                FileScan({SolutionDirectory}tpch/1/lineitem2.parquet) cost (output_rows=6001215, cpu=6001215, disk=49, total=6005) -> .l_quantity, .l_extendedprice, .l_discount, .l_shipdate