SELECT SUM(l_extendedprice * (1 - l_discount)) AS revenue
FROM lineitem, part
WHERE (
    p_partkey = l_partkey
    AND p_brand = 'Brand#12'
    AND p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
    AND l_quantity >= 1
    AND l_quantity <= 1 + 10
    AND p_size BETWEEN 1 AND 5
    AND l_shipmode IN ('AIR', 'AIR REG')
    AND l_shipinstruct = 'DELIVER IN PERSON'
)
OR (
    p_partkey = l_partkey
    AND p_brand = 'Brand#23'
    AND p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
    AND l_quantity >= 10
    AND l_quantity <= 10 + 10
    AND p_size BETWEEN 1 AND 10
    AND l_shipmode IN ('AIR', 'AIR REG')
    AND l_shipinstruct = 'DELIVER IN PERSON'
)
OR (
    p_partkey = l_partkey
    AND p_brand = 'Brand#34'
    AND p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
    AND l_quantity >= 20
    AND l_quantity <= 20 + 10
    AND p_size BETWEEN 1 AND 15
    AND l_shipmode IN ('AIR', 'AIR REG')
    AND l_shipinstruct = 'DELIVER IN PERSON'
);


Original
Project(revenue, rows=6001215) -> .revenue
 Agg(SUM(l_extendedprice * 1 - l_discount)) group by (, rows=6001215) -> .revenue 
    JoinSet(lineitem (Inner) x part (Inner), rows=6001215) -> .l_orderkey, .l_partkey, .l_suppkey, .l_linenumber, .l_quantity, .l_extendedprice, .l_discount, .l_tax, .l_returnflag, .l_linestatus, .l_shipdate, .l_commitdate, .l_receiptdate, .l_shipinstruct, .l_shipmode, .l_comment, .p_partkey, .p_name, .p_mfgr, .p_brand, .p_type, .p_size, .p_container, .p_retailprice, .p_comment    
    UnaryEdge { Expression = l_quantity <= 30, Relation = lineitem }
    UnaryEdge { Expression = l_quantity >= 1, Relation = lineitem }
    UnaryEdge { Expression = p_brand = Brand#12 or p_brand = Brand#23 or p_brand = Brand#34, Relation = part }
    BinaryEdge { Expression = p_brand = Brand#12 and p_container IN subquery(1) and l_quantity >= 1 and l_quantity <= 11 and p_size between 1 and 5 or p_brand = Brand#23 and p_container IN subquery(3) and l_quantity >= 10 and l_quantity <= 20 and p_size between 1 and 10 or p_brand = Brand#34 and p_container IN subquery(4) and l_quantity >= 20 and l_quantity <= 30 and p_size between 1 and 15, One = lineitem, Two = part }
    UnaryEdge { Expression = l_shipinstruct = DELIVER IN PERSON, Relation = lineitem }
    BinaryEdge { Expression = p_partkey = l_partkey, One = lineitem, Two = part }
    UnaryEdge { Expression = l_shipmode IN subquery(2), Relation = lineitem }
       Scan(lineitem, rows=6001215) -> .l_orderkey, .l_partkey, .l_suppkey, .l_linenumber, .l_quantity, .l_extendedprice, .l_discount, .l_tax, .l_returnflag, .l_linestatus, .l_shipdate, .l_commitdate, .l_receiptdate, .l_shipinstruct, .l_shipmode, .l_comment       
       Scan(part, rows=200000) -> .p_partkey, .p_name, .p_mfgr, .p_brand, .p_type, .p_size, .p_container, .p_retailprice, .p_comment       


Optimized
Project(revenue, rows=2400) -> .revenue
 Agg(SUM(l_extendedprice * 1 - l_discount)) group by (, rows=2400) -> .revenue 
    Filter(p_brand = Brand#12 and p_container IN subquery(1) and l_quantity >= 1 and l_quantity <= 11 and p_size between 1 and 5 or p_brand = Brand#23 and p_container IN subquery(3) and l_quantity >= 10 and l_quantity <= 20 and p_size between 1 and 10 or p_brand = Brand#34 and p_container IN subquery(4) and l_quantity >= 20 and l_quantity <= 30 and p_size between 1 and 15, rows=2400) -> .l_partkey, .l_quantity, .l_extendedprice, .l_discount, .l_shipinstruct, .l_shipmode, $subquery_2$.$subquery_2$, .p_partkey, .p_brand, .p_size, .p_container    
       Join(Inner on p_partkey = l_partkey, rows=12002) -> .l_partkey, .l_quantity, .l_extendedprice, .l_discount, .l_shipinstruct, .l_shipmode, $subquery_2$.$subquery_2$, .p_partkey, .p_brand, .p_size, .p_container       
          Join(Semi on l_shipmode = $subquery_2$, rows=60012) -> .l_partkey, .l_quantity, .l_extendedprice, .l_discount, .l_shipinstruct, .l_shipmode, $subquery_2$.$subquery_2$          
             Filter(l_shipinstruct = DELIVER IN PERSON, rows=1200243) -> .l_partkey, .l_quantity, .l_extendedprice, .l_discount, .l_shipinstruct, .l_shipmode             
                Filter(l_quantity >= 1, rows=1200243) -> .l_partkey, .l_quantity, .l_extendedprice, .l_discount, .l_shipinstruct, .l_shipmode                
                   Filter(l_quantity <= 30, rows=1200243) -> .l_partkey, .l_quantity, .l_extendedprice, .l_discount, .l_shipinstruct, .l_shipmode                   
                      Scan(lineitem, rows=6001215) with projection  -> .l_partkey, .l_quantity, .l_extendedprice, .l_discount, .l_shipinstruct, .l_shipmode                      
          
             Scan($subquery_2$, rows=2) -> $subquery_2$.$subquery_2$             
       
          Filter(p_brand = Brand#12 or p_brand = Brand#23 or p_brand = Brand#34, rows=40000) -> .p_partkey, .p_brand, .p_size, .p_container          
             Scan(part, rows=200000) with projection  -> .p_partkey, .p_brand, .p_size, .p_container             


Cost Optimized
Project(revenue) cost (output_rows=2400, cpu=2400, disk=0, total=58881) -> .revenue
 UngroupedAggregate(SUM(l_extendedprice * 1 - l_discount)) cost (output_rows=2400, cpu=2400, disk=0, total=58879) -> .revenue 
    Filter(p_brand = Brand#12 and p_container IN subquery(1) and l_quantity >= 1 and l_quantity <= 11 and p_size between 1 and 5 or p_brand = Brand#23 and p_container IN subquery(3) and l_quantity >= 10 and l_quantity <= 20 and p_size between 1 and 10 or p_brand = Brand#34 and p_container IN subquery(4) and l_quantity >= 20 and l_quantity <= 30 and p_size between 1 and 15) cost (output_rows=2400, cpu=120020, disk=0, total=58876) -> .l_partkey, .l_quantity, .l_extendedprice, .l_discount, .l_shipinstruct, .l_shipmode, .p_partkey, .p_brand, .p_size, .p_container    
       HashJoin(Inner p_partkey, l_partkey) cost (output_rows=12002, cpu=140012, disk=0, total=58756) -> .l_partkey, .l_quantity, .l_extendedprice, .l_discount, .l_shipinstruct, .l_shipmode, .p_partkey, .p_brand, .p_size, .p_container       
          HashJoin(Semi $subquery_2$, l_shipmode) cost (output_rows=60012, cpu=1200247, disk=0, total=57615) -> .l_partkey, .l_quantity, .l_extendedprice, .l_discount, .l_shipinstruct, .l_shipmode          
             Filter(l_shipinstruct = DELIVER IN PERSON) cost (output_rows=1200243, cpu=7201458, disk=0, total=56415) -> .l_partkey, .l_quantity, .l_extendedprice, .l_discount, .l_shipinstruct, .l_shipmode             
                Filter(l_quantity >= 1) cost (output_rows=1200243, cpu=7201458, disk=0, total=49213) -> .l_partkey, .l_quantity, .l_extendedprice, .l_discount, .l_shipinstruct, .l_shipmode                
                   Filter(l_quantity <= 30) cost (output_rows=1200243, cpu=36007290, disk=0, total=42012) -> .l_partkey, .l_quantity, .l_extendedprice, .l_discount, .l_shipinstruct, .l_shipmode                   
                      FileScan({SolutionDirectory}tpch/1/lineitem2.parquet) cost (output_rows=6001215, cpu=6001215, disk=49, total=6005) -> .l_partkey, .l_quantity, .l_extendedprice, .l_discount, .l_shipinstruct, .l_shipmode          
             ScanMemoryTable(Database.Core.BufferPool.MemoryBasedTable) cost (output_rows=2, cpu=2, disk=0, total=0) -> $subquery_2$.$subquery_2$       
          Filter(p_brand = Brand#12 or p_brand = Brand#23 or p_brand = Brand#34) cost (output_rows=40000, cpu=800000, disk=0, total=1000) -> .p_partkey, .p_brand, .p_size, .p_container          
             FileScan({SolutionDirectory}tpch/1/part2.parquet) cost (output_rows=200000, cpu=200000, disk=2, total=200) -> .p_partkey, .p_brand, .p_size, .p_container