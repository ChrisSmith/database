
            select count(*) as count
            from table t
            where t.CategoricalInt = (
                select max(CategoricalInt)
                from table q
                where q.CategoricalString = 'cat'
            )
        

Original
PlanWithSubQueries(u=1, rows=20000) -> .count
 Project(max(CategoricalInt), rows=20000) -> .max(CategoricalInt) 
    Agg(max(CategoricalInt)) group by (, rows=20000) -> .max(CategoricalInt)    
       Filter(CategoricalString = cat, rows=20000) -> q.Id, q.Unordered, q.Name, q.CategoricalInt, q.CategoricalString       
          Scan(table, rows=100000) -> q.Id, q.Unordered, q.Name, q.CategoricalInt, q.CategoricalString          
 Project(count, rows=20000) -> .count 
    Agg(count(*)) group by (, rows=20000) -> .count    
       Filter(CategoricalInt = subquery(1), rows=20000) -> t.Id, t.Unordered, t.Name, t.CategoricalInt, t.CategoricalString       
          Scan(table, rows=100000) -> t.Id, t.Unordered, t.Name, t.CategoricalInt, t.CategoricalString          


Optimized
PlanWithSubQueries(u=1, rows=20000) -> .count
 Project(max(CategoricalInt), rows=20000) -> .max(CategoricalInt) 
    Agg(max(CategoricalInt)) group by (, rows=20000) -> .max(CategoricalInt)    
       Filter(CategoricalString = cat, rows=20000) -> q.CategoricalInt, q.CategoricalString       
          Scan(table, rows=100000) with projection  -> q.CategoricalInt, q.CategoricalString          
 Project(count, rows=20000) -> .count 
    Agg(count(*)) group by (, rows=20000) -> .count    
       Filter(CategoricalInt = subquery(1), rows=20000) -> t.CategoricalInt       
          Scan(table, rows=100000) with projection  -> t.CategoricalInt          


Cost Optimized
PlanWithSubQueries(u=1) -> .count
 Project(max(CategoricalInt)) cost (output_rows=20000, cpu=20000, disk=0, total=341) -> .max(CategoricalInt) 
    UngroupedAggregate(max(CategoricalInt)) cost (output_rows=20000, cpu=20000, disk=0, total=321) -> .max(CategoricalInt)    
       Filter(CategoricalString = cat) cost (output_rows=20000, cpu=200000, disk=0, total=301) -> q.CategoricalInt, q.CategoricalString       
          FileScan({SolutionDirectory}data.parquet) cost (output_rows=100000, cpu=100000, disk=10, total=101) -> q.CategoricalInt, q.CategoricalString Project(count) cost (output_rows=20000, cpu=20000, disk=0, total=241) -> .count 
    UngroupedAggregate(count(*)) cost (output_rows=20000, cpu=20000, disk=0, total=221) -> .count    
       Filter(CategoricalInt = subquery(1)) cost (output_rows=20000, cpu=100000, disk=0, total=201) -> t.CategoricalInt       
          FileScan({SolutionDirectory}data.parquet) cost (output_rows=100000, cpu=100000, disk=10, total=101) -> t.CategoricalInt